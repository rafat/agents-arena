# Agents Arena
<div align="center"><img src="https://github.com/rafat/agents-arena/blob/main/public/image.webp"  width="512" alt="WebP Image" /></div>


The concept is old as time but the recent unitree robot boxing matches make it clear that with the advancements in AI and Robotics mainly because of reinforcement learning we are only a few short years away from fully autonomous robots duking it out in an arena. If their fighting robots that are good enough to put up an entertaining fight then the audience and money will follow. I believe blockchain/ledger technology will be an integral part of this equation to make sure that there is trust and verfifiability in this process. For this project we are not putting unitree robots to fight. Our "robots" are AI agents powered by OpenAI and the fight outcomes are powered by [Flow Network's Cadence Arch](https://github.com/onflow/flips/blob/main/protocol/20231116-evm-support.md#cadence-arch)

Here is our tech stack : 
1. Contracts (AgentFactory.sol and Arena.sol) deployed on Flow Testnet
2. Next.js 15+ Frontend
3. Open AI Dall-E-3 model to generate Ai Agents Image.
4. Open AI GPT-4O-mini model to make decisions for AI agent based on its "DNA", its record, its opponents' record and some other battle data.
5. Supabase and IPFS(Pinata) to store and cache some data that we don't want stored on the blockchain itself.

## Contracts

1. Agents factory contract deployed on Flow Testnet at [0x8b0348a2EFA87dcBF2B5a179149E21708f62342f](https://evm-testnet.flowscan.io/address/0x8b0348a2EFA87dcBF2B5a179149E21708f62342f)
2. Arena contract deployed on Flow Testnet at [0x644050Bd1200cf3692682d90BF145E84080dc0B4](https://evm-testnet.flowscan.io/address/0x644050Bd1200cf3692682d90BF145E84080dc0B4)

   Contracts repository is [here](https://github.com/encoderafat/agents-arena-contracts)

Agents struct at minting
```
Agent({
id: newId,
level: 1,
experience: 0,
dna: newDna,
metadataCID: _metadataCID,
equippedItem: 0
});
```
where initial four dimensional DNA {strength, agility, intelligence, elementalAffibity} is generated using CadenceArch's revertibleRandom() to make sure that the agents are sufficiently different from each other. We call it DNA but it is an evolving metrics and agents can level up by fighting and gaining experience.

Arena contract has two functions : startBattle() and fight() 
```
function startBattle(
        uint256 _agent1Id,
        BattleTactics memory _tactics1,
        uint256 _agent2Id,
        BattleTactics memory _tactics2
)

function fight(uint256 _battleId)
```

startBattle() sets up the battle between two agents, generates/emits the battle ID and also stores the tactics that will determine the fight outcome. You call fight() with the battle Id to start the fight.We use a VRF seed (CadenceArch's revertibleRandom()) for the entire battle's sequence of events and it is a fight that will last a maximum of three rounds. It is a fairly simple logic with a tie-breaker if the agents somehow end up tied.
 
Tactics are generated by OpenAI's gpt-4o-mini model using a simple customized prompt [available here](https://github.com/rafat/agents-arena/blob/28c730f4cc09b44940d8ebf3f8080881529af1ac/lib/ai/strategy.ts#L53) which returns the tactics in this JSON format
```
{
      "aggressiveness": 50,
      "strategy": "Tactician",
      "riskTolerance": 40,
      "reasoning": "detailed explanation of tactical choices"
    }
```

There is also a simple if-else type of tactics generation step if the AI response fails for some reason.

## Getting Started Locally

Clone the repo. Copy .example file to .env

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.


## TO-DO And The Next Steps
